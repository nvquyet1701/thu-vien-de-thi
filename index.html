<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Th∆∞ Vi·ªán ƒê·ªÅ Thi</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; background-color: #f6f8fa; color: #24292e; }
        
        /* Header & Search */
        h1 { text-align: center; color: #0366d6; margin-bottom: 20px; }
        .search-container { position: relative; margin-bottom: 20px; }
        .search-box { width: 100%; padding: 12px 15px; font-size: 16px; border: 1px solid #d1d5da; border-radius: 6px; box-sizing: border-box; box-shadow: inset 0 1px 2px rgba(27,31,35,0.075); transition: 0.2s; }
        .search-box:focus { border-color: #0366d6; outline: none; box-shadow: 0 0 0 3px rgba(3,102,214,0.3); }

        /* Breadcrumb (Thanh ƒë∆∞·ªùng d·∫´n) */
        .breadcrumb { background: #fff; padding: 10px 15px; border-radius: 6px 6px 0 0; border: 1px solid #e1e4e8; border-bottom: none; display: flex; align-items: center; gap: 5px; font-size: 14px; color: #586069; }
        .breadcrumb span { cursor: pointer; color: #0366d6; font-weight: 500; }
        .breadcrumb span:hover { text-decoration: underline; }
        .breadcrumb span.current { color: #586069; pointer-events: none; text-decoration: none; font-weight: normal; }
        
        /* List Items */
        #file-list { list-style: none; padding: 0; margin: 0; background: white; border: 1px solid #e1e4e8; border-radius: 0 0 6px 6px; }
        .item { padding: 12px 15px; border-bottom: 1px solid #e1e4e8; cursor: pointer; display: flex; align-items: center; transition: background 0.15s; }
        .item:last-child { border-bottom: none; border-radius: 0 0 6px 6px; }
        .item:hover { background-color: #f6f8fa; }
        
        /* Icons & Text */
        .icon { margin-right: 12px; font-size: 1.2em; min-width: 24px; text-align: center; }
        .item-name { flex-grow: 1; font-weight: 500; color: #24292e; text-decoration: none; }
        .file-link { color: #24292e; text-decoration: none; width: 100%; display: flex; align-items: center; }
        .file-link:hover .item-name { color: #0366d6; text-decoration: underline; }
        
        .loading { text-align: center; padding: 20px; color: #666; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <h1>üìö Th∆∞ Vi·ªán ƒê·ªÅ Thi</h1>
    
    <div class="search-container">
        <input type="text" id="search" class="search-box" placeholder="üîç T√¨m nhanh b√†i, ch∆∞∆°ng ho·∫∑c kh·ªëi..." onkeyup="handleSearch()">
    </div>

    <div id="breadcrumb" class="breadcrumb">
        <span onclick="navigateTo([])">üè† Trang ch·ªß</span>
    </div>

    <ul id="file-list">
        <li class="loading">‚è≥ ƒêang t·∫£i d·ªØ li·ªáu t·ª´ GitHub...</li>
    </ul>

    <script>
        // --- C·∫§U H√åNH (Thay ƒë·ªïi th√¥ng tin c·ªßa b·∫°n ·ªü ƒë√¢y) ---
        const USERNAME = 'TEN_GITHUB_CUA_BAN'; // V√≠ d·ª•: nguyenvana
        const REPO_NAME = 'TEN_REPO_CUA_BAN';  // V√≠ d·ª•: thu-vien-de-thi
        // ---------------------------------------------------

        const apiUrl = `https://api.github.com/repos/${USERNAME}/${REPO_NAME}/git/trees/main?recursive=1`;
        let allItems = []; // Ch·ª©a to√†n b·ªô d·ªØ li·ªáu t·∫£i v·ªÅ
        let currentPath = []; // M·∫£ng l∆∞u v·ªã tr√≠ hi·ªán t·∫°i, vd: ['Khoi-10', 'Chuong-1']

        // 1. T·∫£i d·ªØ li·ªáu
        async function fetchFiles() {
            try {
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                // L·ªçc b·ªè file h·ªá th·ªëng
                allItems = data.tree.filter(item => item.path !== 'index.html' && item.path !== '.gitignore');
                renderView(); // Hi·ªÉn th·ªã l·∫ßn ƒë·∫ßu (Trang ch·ªß)
            } catch (error) {
                document.getElementById('file-list').innerHTML = '<li class="item" style="color:red">‚ùå L·ªói t·∫£i d·ªØ li·ªáu. Ki·ªÉm tra l·∫°i T√™n User/Repo trong file index.html</li>';
            }
        }

        // 2. Logic Hi·ªÉn th·ªã (Quan tr·ªçng nh·∫•t)
        function renderView(isSearch = false, searchResults = []) {
            const list = document.getElementById('file-list');
            list.innerHTML = '';

            // N·∫øu ƒëang search th√¨ hi·ªÉn th·ªã k·∫øt qu·∫£ search
            if (isSearch) {
                document.getElementById('breadcrumb').classList.add('hidden'); // ·∫®n breadcrumb khi search
                if (searchResults.length === 0) {
                    list.innerHTML = '<li class="item" style="color:#666">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o.</li>';
                    return;
                }
                searchResults.forEach(file => renderFileItem(list, file, true));
                return;
            }

            // N·∫øu kh√¥ng search -> Hi·ªÉn th·ªã theo th∆∞ m·ª•c (Folder View)
            document.getElementById('breadcrumb').classList.remove('hidden');
            updateBreadcrumb();

            // L·∫•y danh s√°ch item ·ªü c·∫•p hi·ªán t·∫°i
            const currentLevelItems = getItemsAtCurrentPath();
            
            // Render Folder tr∆∞·ªõc
            currentLevelItems.folders.forEach(folderName => {
                const li = document.createElement('li');
                li.className = 'item';
                li.onclick = () => {
                    currentPath.push(folderName); // ƒêi s√¢u v√†o 1 c·∫•p
                    document.getElementById('search').value = ''; // X√≥a t√¨m ki·∫øm n·∫øu c√≥
                    renderView();
                };
                li.innerHTML = `<span class="icon">üìÅ</span> <span class="item-name">${folderName}</span> <span style="color:#ccc">‚Ä∫</span>`;
                list.appendChild(li);
            });

            // Render File sau
            currentLevelItems.files.forEach(file => renderFileItem(list, file));

            if (currentLevelItems.folders.length === 0 && currentLevelItems.files.length === 0) {
                 list.innerHTML = '<li class="item" style="color:#666">Th∆∞ m·ª•c tr·ªëng</li>';
            }
        }

        // H√†m h·ªó tr·ª£: L·ªçc item ·ªü c·∫•p hi·ªán t·∫°i
        function getItemsAtCurrentPath() {
            const prefix = currentPath.join('/');
            const folders = new Set();
            const files = [];

            allItems.forEach(item => {
                // Ki·ªÉm tra xem item c√≥ n·∫±m trong folder hi·ªán t·∫°i kh√¥ng
                if (item.path.startsWith(prefix ? prefix + '/' : '')) {
                    // C·∫Øt b·ªè ph·∫ßn prefix ƒë·ªÉ l·∫•y ph·∫ßn ƒëu√¥i
                    const relativePath = prefix ? item.path.slice(prefix.length + 1) : item.path;
                    const parts = relativePath.split('/');

                    if (parts.length > 1) {
                        // ƒê√¢y l√† folder con (v√¨ c√≤n d·∫•u / ph√≠a sau)
                        folders.add(parts[0]);
                    } else {
                        // ƒê√¢y l√† file n·∫±m ngay ·ªü c·∫•p n√†y
                        if (item.type === 'blob') files.push(item);
                    }
                }
            });
            // S·∫Øp x·∫øp folder theo t√™n
            return { folders: Array.from(folders).sort(), files: files };
        }

        // H√†m h·ªó tr·ª£: V·∫Ω giao di·ªán 1 file
        function renderFileItem(container, file, showFullPath = false) {
            const url = `https://github.com/${USERNAME}/${REPO_NAME}/blob/main/${file.path}`;
            const parts = file.path.split('/');
            const fileName = parts.pop();
            const displayName = showFullPath ? file.path : fileName; // N·∫øu search th√¨ hi·ªán full path

            const li = document.createElement('li');
            li.className = 'item';
            li.innerHTML = `
                <a href="${url}" target="_blank" class="file-link">
                    <span class="icon">üìÑ</span> 
                    <span class="item-name">${displayName}</span>
                </a>
            `;
            container.appendChild(li);
        }

        // 3. X·ª≠ l√Ω t√¨m ki·∫øm
        function handleSearch() {
            const query = document.getElementById('search').value.toLowerCase().trim();
            if (!query) {
                renderView(); // Tr·∫£ v·ªÅ ch·∫ø ƒë·ªô folder n·∫øu √¥ t√¨m ki·∫øm r·ªóng
                return;
            }
            // L·ªçc to√†n b·ªô file c√≥ t√™n ch·ª©a t·ª´ kh√≥a
            const results = allItems.filter(item => 
                item.type === 'blob' && item.path.toLowerCase().includes(query)
            );
            renderView(true, results);
        }

        // 4. X·ª≠ l√Ω Breadcrumb (Thanh ƒëi·ªÅu h∆∞·ªõng)
        function updateBreadcrumb() {
            const bc = document.getElementById('breadcrumb');
            bc.innerHTML = '<span onclick="navigateTo([])">üè† Trang ch·ªß</span>';
            
            let accumPath = [];
            currentPath.forEach((folder, index) => {
                bc.innerHTML += ' <span>/</span> ';
                accumPath.push(folder);
                
                // N·∫øu l√† folder cu·ªëi c√πng th√¨ kh√¥ng cho click (bold), ng∆∞·ª£c l·∫°i t·∫°o link click
                if (index === currentPath.length - 1) {
                    bc.innerHTML += `<span class="current">${folder}</span>`;
                } else {
                    // Clone m·∫£ng ƒë·ªÉ tr√°nh tham chi·∫øu
                    const pathForClick = [...accumPath]; 
                    const span = document.createElement('span');
                    span.innerText = folder;
                    span.onclick = () => navigateTo(pathForClick);
                    bc.appendChild(span);
                }
            });
        }

        function navigateTo(path) {
            currentPath = path;
            renderView();
        }

        fetchFiles();
    </script>
</body>
</html>
